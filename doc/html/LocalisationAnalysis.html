

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Analysing Localisation Microscopy data &mdash; PYME 19.02.27 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Analysing data not generated by PYMEAcquire" href="AnalysingForeignData.html" />
    <link rel="prev" title="Common Tasks" href="component_programs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PYME
          

          
            
            <img src="_static/pymeLogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                19.02.27
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation/InstallationWithAnaconda.html">Installation of PYME on 64 bit Windows, OSX, or Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation/InstallationFromSource.html">Installation for development or instrument control</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="PYMEAcquire.html"><strong>PYMEAcquire</strong> - Instrument control and simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Analysis.html"><strong>dh5view</strong> - Image Data Analysis and Viewing</a></li>
<li class="toctree-l1"><a class="reference internal" href="VisGUI.html"><strong>VisGUI</strong> - Visualising Localization Data Sets</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="component_programs.html">Common Tasks</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Analysing Localisation Microscopy data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AnalysingForeignData.html">Analysing data not generated by PYMEAcquire</a></li>
<li class="toctree-l3"><a class="reference internal" href="SplitterMulticolour.html">Using an image splitting device for multi-colour ratiometric imaging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distributed-analysis-and-queues">Distributed analysis and queues</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#distributing-over-multiple-computers">Distributing over multiple computers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#loading-data">Loading data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-settings">Analysis settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fit-types">Fit types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#starting-the-fitting">Starting the fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#testing-the-object-detection">Testing the object detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#launching-the-analysis-tasks">Launching the analysis tasks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="PSFExtraction.html">PSF Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Recipes.html">Using recipes for data processing and quantification</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtos/distancecolocalization.html">Distance transform colocalization HOWTO</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Development / Hacking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hacking.html">Extending PYME and writing plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="hacking.html#technical-details">Technical Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="hacking.html#api-documentation">API Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PYME</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="component_programs.html">Common Tasks</a> &raquo;</li>
        
      <li>Analysing Localisation Microscopy data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="analysing-localisation-microscopy-data">
<span id="localisationanalysis"></span><h1>Analysing Localisation Microscopy data<a class="headerlink" href="#analysing-localisation-microscopy-data" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="AnalysingForeignData.html">Analysing data not generated by PYMEAcquire</a></li>
<li class="toctree-l1"><a class="reference internal" href="SplitterMulticolour.html">Using an image splitting device for multi-colour ratiometric imaging</a></li>
</ul>
</div>
<div class="section" id="distributed-analysis-and-queues">
<h2>Distributed analysis and queues<a class="headerlink" href="#distributed-analysis-and-queues" title="Permalink to this headline">¶</a></h2>
<p>PYME has a distributed analysis model whereby a server process manages <em>Task Queues</em>
and distributes groups of frames to
multiple different worker processes. These can either all be on the same machine, or be distributed
across a network/cluster. These server and worker processes need to be running before starting the analysis. The <code class="docutils literal notranslate"><span class="pre">launchWorkers.py</span></code>
script simplifies this by starting the server and the same number of workers as there
are cores on the current machine. To communicate with each other the server and worker
processes use a package called Pyro, and a pyro nameserver needs to be running so workers and
servers can find each other. If there is no name server running on the local network, launchWorkers
starts one, but this is probably only suitable/robust if only one machine is being used
for analysis.</p>
<p>If you’re running the analysis on the data acquisition computer, and have a decent number of
cores available (e.g. 8),  better performance can be achieved by reserving a core for
each of the Acqusition and Server processes (ie limiting the number of workers to 6 in our
8 core case). This can be done by explicitly specifying the number of workers to launch as
an argument eg: <code class="docutils literal notranslate"><span class="pre">launchWorkers</span> <span class="pre">6</span></code>.</p>
<div class="section" id="distributing-over-multiple-computers">
<h3>Distributing over multiple computers<a class="headerlink" href="#distributing-over-multiple-computers" title="Permalink to this headline">¶</a></h3>
<p>Distributing the analysis over multiple computers (a small ad-hoc cluster) is now easy:</p>
<ul class="simple">
<li>Make sure that the same version of PYME is installed on all machines</li>
<li>Run <code class="docutils literal notranslate"><span class="pre">launchWorkers</span></code> on each machine you want to use.</li>
</ul>
</div>
</div>
<div class="section" id="loading-data">
<h2>Loading data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h2>
<p>Once the server and worker processes are running, the data should be opened
using <a class="reference internal" href="dh5view.html#dh5view"><span class="std std-ref">dh5view</span></a>. For data spooled to a <code class="docutils literal notranslate"><span class="pre">.h5</span> <span class="pre">file</span></code> this can be
performed as one would expect, by either specifying the filename on the command
line or by ascociating <code class="docutils literal notranslate"><span class="pre">dh5view</span></code> with <code class="docutils literal notranslate"><span class="pre">.h5</span></code> files. For data saved directly to
a queue, the easiest way is probably to click the <strong>Analyse</strong> button on the
Spooling panel in <a class="reference internal" href="PYMEAcquire.html#pymeacquire"><span class="std std-ref">PYMEAcquire</span></a>. Many protocols will do this
automatically after a the intial pre-bleaching phase has been performed.</p>
<p>For data not originating from <em>PYMEAcquire</em> the process is a little more complex
(see <a class="reference internal" href="AnalysingForeignData.html#analysingforeigndata"><span class="std std-ref">Analysing data not generated by PYMEAcquire</span></a>). Similarly, special attention is needed for analysing
simultaeneous multi-colour data (see <a class="reference internal" href="SplitterMulticolour.html#imagesplitter"><span class="std std-ref">Using an image splitting device for multi-colour ratiometric imaging</span></a>).</p>
</div>
<div class="section" id="analysis-settings">
<h2>Analysis settings<a class="headerlink" href="#analysis-settings" title="Permalink to this headline">¶</a></h2>
<p>With the data loaded in dh5view, one should see something like:</p>
<img alt="_images/dh5view_lm.png" src="_images/dh5view_lm.png" />
<p>The <strong>Analysis</strong> and <strong>Point Finding</strong> panes in the left hand panel control the
analysis settings. The settings are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Threshold</td>
<td>The threshold for event detection. This is not a strict threshold, but
rather a scaling factor applied to a local threhold computed from the
estimated pixel SNR. Will generally not need to be altered (except for
some of the interpolation based fits)</td>
</tr>
<tr class="row-odd"><td>Type</td>
<td>The type of fit to perform</td>
</tr>
<tr class="row-even"><td>Interp</td>
<td>The type of interpolation to perform (only methods with <em>Interp</em> in
their name)</td>
</tr>
<tr class="row-odd"><td>Start at</td>
<td>The frame # should to start our analysis at</td>
</tr>
<tr class="row-even"><td>Background</td>
<td>What range of frames should be used for background estimation. Uses
python slice notation.</td>
</tr>
<tr class="row-odd"><td>Debounce r</td>
<td>The radius (in pixels) within which 2 events cannot be reliably
distinguished</td>
</tr>
<tr class="row-even"><td>Shifts</td>
<td>The shift field to use for chromatic shift correction (only methods with
<em>Splitter</em> in their name.</td>
</tr>
<tr class="row-odd"><td>PSF</td>
<td>The PSF measurement to use (only <em>Interp</em> methods</td>
</tr>
<tr class="row-even"><td>Estimate Drift</td>
<td>Whether to estimate drift using fiduciaries <strong>[BROKEN]</strong></td>
</tr>
<tr class="row-odd"><td>Subtract background</td>
<td>Should we subtract the background before fitting (rather than
just event detection)</td>
</tr>
</tbody>
</table>
<div class="section" id="fit-types">
<h3>Fit types<a class="headerlink" href="#fit-types" title="Permalink to this headline">¶</a></h3>
<p>PYME offers a number of different fit types, and is easily extensible to support more.
The current ones are, with the ones you’d usually want to use in bold:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ConfocCOIR</td>
<td>Determines a 3D COI from confocal/widefield data</td>
</tr>
<tr class="row-odd"><td>Gauss3DFitR</td>
<td>Fits a 3D gaussian to confocal/widefield data</td>
</tr>
<tr class="row-even"><td><strong>InterpFitR</strong></td>
<td>Fits an interpolated PSF to localisation Data (<strong>3D</strong>)</td>
</tr>
<tr class="row-odd"><td>LatFitCOIR</td>
<td>Determines the position of events by taking their centroid.
Fast but not as good as a proper fit.</td>
</tr>
<tr class="row-even"><td><strong>LatGaussFitFR</strong></td>
<td>Simple 2D gaussian fitting.</td>
</tr>
<tr class="row-odd"><td>LatObjFindFR</td>
<td>Just perform the object finding part of the fitting process</td>
</tr>
<tr class="row-even"><td>LatPSFFitR</td>
<td>Fits a symplified model of a widefield PSF (<strong>3D</strong>). Use
InterpFitR instead</td>
</tr>
<tr class="row-odd"><td>SplitterFitCOIR</td>
<td>Determines centroids when two channels are split onto
separate halves of the CCD</td>
</tr>
<tr class="row-even"><td>SplitterFitFR</td>
<td>Like LatGaussFitFR but for split data</td>
</tr>
<tr class="row-odd"><td><strong>SplitterFitInterpR</strong></td>
<td>Like InterpFitR but for split data (<strong>3D</strong>)</td>
</tr>
<tr class="row-even"><td><strong>SplitterFitQR</strong></td>
<td>Faster version of SplitterFitFR (ommits background parameters)</td>
</tr>
<tr class="row-odd"><td>SplitterObjFindR</td>
<td>Like LatObjFindFR, but for split data</td>
</tr>
<tr class="row-even"><td>SplitterShiftEstFR</td>
<td>Used for estimating shift fields</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="starting-the-fitting">
<h2>Starting the fitting<a class="headerlink" href="#starting-the-fitting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="testing-the-object-detection">
<h3>Testing the object detection<a class="headerlink" href="#testing-the-object-detection" title="Permalink to this headline">¶</a></h3>
<p>Whilst the threhold factor is fairly robust, it is generally worth testing the
detection by clicking the <strong>Test</strong> button. This performs the object finding step
on a selection of frames spaced throughout the sequence. If this fails one should
check the <code class="docutils literal notranslate"><span class="pre">Camera.ADOffset</span></code> setting in the metadata (accessible through the <strong>Metadata</strong> tab)
to see if this is reasonable before attempting to tweak the detection threshold. (The <em>ADOffset</em> is estimated by
taking a number of dark frames before the acquisition starts, and can be fooled if
the room lights are on and/or the laser shutters are misbehaving). Metadata parameters
can be edited by right clicking the appropriate field in the Metadata tab.</p>
</div>
<div class="section" id="launching-the-analysis-tasks">
<h3>Launching the analysis tasks<a class="headerlink" href="#launching-the-analysis-tasks" title="Permalink to this headline">¶</a></h3>
<p>Once satisfied with the event detection, the analysis proper can be started by
clicking the <strong>Go</strong> button. The results will automatically be saved, either under the
<code class="docutils literal notranslate"><span class="pre">PYMEDATADIR</span></code> directory (if the environment variable was set earlier), or in a directory
called <code class="docutils literal notranslate"><span class="pre">PYMEData</span></code> in the users home directory (<code class="docutils literal notranslate"><span class="pre">c:\\Users\\&lt;username&gt;\\</span></code> under windows).</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="AnalysingForeignData.html" class="btn btn-neutral float-right" title="Analysing data not generated by PYMEAcquire" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="component_programs.html" class="btn btn-neutral float-left" title="Common Tasks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, David Baddeley

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>